<!DOCTYPE html>
<html lang="tk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adiabatik Gi≈àelme Tejribesi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #7c3aed;
            --success: #10b981;
            --danger: #ef4444;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .content-section {
            display: none;
            background: var(--surface);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .content-section.active {
            display: block;
        }

        .theory-box {
            background: linear-gradient(135deg, #eff6ff, #f0f9ff);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--primary);
        }

        .formula {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            text-align: center;
            border: 2px solid var(--border);
        }

        .simulation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        canvas {
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            width: 100%;
            max-width: 100%;
            height: 400px;
            display: block;
        }

        .controls {
            background: var(--surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .input-group {
            margin: 15px 0;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text);
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .result-card {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .result-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .result-value {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--primary);
        }

        .steps {
            list-style-position: inside;
            padding: 20px;
        }

        .steps li {
            margin: 15px 0;
            padding: 15px;
            background: var(--bg);
            border-radius: 8px;
            border-left: 4px solid var(--secondary);
        }

        @media (max-width: 768px) {
            .simulation-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            h1 {
                font-size: 1.5em;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip-text {
            visibility: hidden;
            background-color: #333;
            color: white;
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
            white-space: nowrap;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¨ Adiabatik Gi≈àelme Tejribesi</h1>
            <p>Ideal gazy≈à adiabatik gi≈àelmesinde basy≈ü, udel, temperatura we i≈ü gatna≈üyklaryny √∂wrenmek</p>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="showTab('intro')">Giri≈ü</div>
            <div class="tab" onclick="showTab('theory')">Teori√Ωa</div>
            <div class="tab" onclick="showTab('steps')">Tejribe √Ñdimleri</div>
            <div class="tab" onclick="showTab('simulation')">Simul√Ωasi√Ωa</div>
            <div class="tab" onclick="showTab('results')">Netijeler</div>
        </div>

        <div id="intro" class="content-section active">
            <h2>Tejrib√§ni≈à Maksady</h2>
            <p style="font-size: 1.1em; margin: 20px 0;">Bu tejribede ideal gazy≈à adiabatik gi≈àelmesini √∂wren√Ω√§ris. Adiabatik proses ‚Äî da≈üary gur≈üaw bilen √Ωylylyk aly≈ü-√ßal≈üygy bolma√Ωan termodinamiki proses.</p>
            
            <div class="theory-box">
                <h3>üìã Zerur Enjamlar:</h3>
                <ul style="margin: 15px 0 15px 30px;">
                    <li>√ùapyk silindr (piston bilen)</li>
                    <li>Basy≈ü √∂l√ße√Ωji (manometr)</li>
                    <li>Temperatura √∂l√ße√Ωji (termometr)</li>
                    <li>Udel √∂l√ße√Ωji (gradarowany≈à √ßyzygy)</li>
                    <li>√ùylylyk izol√Ωasi√Ωa materiallary</li>
                    <li>Komp√Ωuter simul√Ωasi√Ωa programmasy</li>
                </ul>
            </div>

            <div class="theory-box">
                <h3>üéØ √ñwrenjek Zatlarymyz:</h3>
                <ul style="margin: 15px 0 15px 30px;">
                    <li>PV<sup>Œ≥</sup> = konstant (adiabatik ≈üert)</li>
                    <li>Basy≈ü we udeli≈à arasyndaky baglany≈üyk</li>
                    <li>Temperatura √∂zgeri≈üi</li>
                    <li>Gazy≈à √Ωerine √Ωetiren i≈üi</li>
                    <li>√ùylylyk balansyny≈à √Ωokdugy (Q = 0)</li>
                </ul>
            </div>
        </div>

        <div id="theory" class="content-section">
            <h2>Teori√Ωa Esaslary</h2>
            
            <div class="theory-box">
                <h3>‚ùì Adiabatik Proses N√§me?</h3>
                <p>Adiabatik proses ‚Äî ulgam bilen da≈üary gur≈üaw arasynda √Ωylylyk ge√ßi≈üi bolma√Ωan termodinamiki proses. Bu prosesde gazy≈à √§hli energia √∂zgeri≈üi di≈àe i≈ü arkaly bol√Ωar.</p>
            </div>

            <div class="theory-box">
                <h3>üìê Esasy Formulalar:</h3>
                
                <div class="formula">
                    <strong>1. Adiabatik ≈ûert:</strong><br>
                    PV<sup>Œ≥</sup> = konstant
                </div>
                <p><strong>D√º≈ü√ºndiri≈ü:</strong> Basy≈ü (P) we udel (V) k√∂peldilende Œ≥ derejesi bilen konstant gal√Ωar. Œ≥ (gamma) - √Ωylylyk sygymlaryny≈à gatna≈üygy (C<sub>p</sub>/C<sub>v</sub>).</p>
                <p><strong>Mysal:</strong> Howa √º√ßin Œ≥ ‚âà 1.4. Eger ba≈ülangy√ß P‚ÇÅV‚ÇÅ<sup>1.4</sup> = 100, so≈àky √Ωagda√Ωda P‚ÇÇV‚ÇÇ<sup>1.4</sup> = 100 bolmaly.</p>

                <div class="formula">
                    <strong>2. Temperatura Baglany≈üygy:</strong><br>
                    TV<sup>Œ≥-1</sup> = konstant
                </div>
                <p><strong>D√º≈ü√ºndiri≈ü:</strong> Gaz gi≈àelende (V √Ωokarlananda) temperatura (T) pesle√Ω√§r. Bu udel we temperaturany≈à arasynda eksponsial baglany≈üyk.</p>
                <p><strong>Mysal:</strong> Eger udel 2 esse √Ωokarlan√Ωar, temperatura T‚ÇÇ = T‚ÇÅ √ó (V‚ÇÅ/V‚ÇÇ)<sup>0.4</sup> formulasy bilen kesel√Ω√§r.</p>

                <div class="formula">
                    <strong>3. Gazy≈à √ùerine √ùetiren I≈üi:</strong><br>
                    W = ‚à´ P dV = (P‚ÇÅV‚ÇÅ - P‚ÇÇV‚ÇÇ) / (Œ≥ - 1)
                </div>
                <p><strong>D√º≈ü√ºndiri≈ü:</strong> Gaz gi≈àelende da≈üyna i≈ü √Ωerine √Ωetir√Ω√§r. Bu i≈ü basy≈ü-udel e√Ωrisini≈à astyndaky me√Ωdana de≈àdir.</p>
                <p><strong>Mysal:</strong> P‚ÇÅ=100kPa, V‚ÇÅ=1L, P‚ÇÇ=50kPa, V‚ÇÇ=1.64L, Œ≥=1.4 √º√ßin: W = (100√ó1 - 50√ó1.64)/(1.4-1) = 45 J</p>

                <div class="formula">
                    <strong>4. √ùylylyk Ge√ßi≈üi:</strong><br>
                    Q = 0 (adiabatik proses √º√ßin)
                </div>
                <p><strong>D√º≈ü√ºndiri≈ü:</strong> Adiabatik prosesde √Ωylylyk ge√ßi≈üi √Ωok, ≈üonu≈à √º√ßin Q = 0. √Ñhli energia √º√Ωtgemesi i≈ü arkaly bol√Ωar.</p>

                <div class="formula">
                    <strong>5. Termodinamikany≈à Birinji Kanuny:</strong><br>
                    ŒîU = Q - W = -W (adiabatik √º√ßin)
                </div>
                <p><strong>D√º≈ü√ºndiri≈ü:</strong> I√ßki energi√Ωany≈à √º√Ωtgemesi √Ωerine √Ωetirilen i≈üe de≈àdir (ters alamatly), seb√§bi Q=0.</p>
            </div>

            <div class="theory-box">
                <h3>üìä Gamma (Œ≥) Bahalary:</h3>
                <ul style="margin: 15px 0 15px 30px;">
                    <li><strong>Bir atomly gazlar (He, Ar):</strong> Œ≥ = 1.67 (5/3)</li>
                    <li><strong>Iki atomly gazlar (N‚ÇÇ, O‚ÇÇ, Howa):</strong> Œ≥ = 1.40 (7/5)</li>
                    <li><strong>√ú√ß we k√∂p atomly gazlar (CO‚ÇÇ):</strong> Œ≥ = 1.30</li>
                </ul>
            </div>
        </div>

        <div id="steps" class="content-section">
            <h2>Tejribe √Ñdimleri</h2>
            
            <ol class="steps">
                <li>
                    <strong>1. Ta√Ω√Ωarlyk:</strong> Silindri √Ωylylyk izol√Ωasi√Ωa materiallary bilen √∂rt√º≈à. Piston we silindri≈à i√ßki √Ω√ºz√ºni arassala≈à.
                    <br><small>üéØ Maksat: Adiabatik ≈üerti √ºpj√ºn etmek (da≈üyna √Ωylylyk ge√ßirmezlik)</small>
                </li>
                <li>
                    <strong>2. Ba≈ülangy√ß √ñl√ßegler:</strong> Basy≈ü (P‚ÇÅ), udel (V‚ÇÅ) we temperatura (T‚ÇÅ) ba≈ülangy√ß bahalaryny √Ωazga aly≈à.
                    <br><small>üìè N√§me √∂l√ße√Ω√§ris: P‚ÇÅ = 100-200 kPa, V‚ÇÅ = 0.5-1.0 L, T‚ÇÅ = 293-300 K</small>
                </li>
                <li>
                    <strong>3. √áalt Gi≈àelme:</strong> Pistony √ßalt dart—ã–ø, gazy≈à udelini √Ωokarlandyry≈à. Bu proses m√ºmkin boldugy√ßa √ßalt bolmaly.
                    <br><small>‚ö° Seb√§p: √áalt gi≈àelme √Ωylylyk ge√ßi≈üini≈à √∂≈à√ºni al√Ωar we adiabatik ≈üerti √ºpj√ºn ed√Ω√§r</small>
                </li>
                <li>
                    <strong>4. So≈àky √ñlƒçegler:</strong> Gi≈àelmeden so≈à basy≈ü (P‚ÇÇ), udel (V‚ÇÇ) we temperatura (T‚ÇÇ) t√§ze bahalaryny dessine √∂lƒç√§≈à we √Ωazga aly≈à.
                    <br><small>üìä Gara≈üyl√Ωan netije: P‚Üì, V‚Üë, T‚Üì (basy≈ü we temperatura peseler, udel √Ωokarlanar)</small>
                </li>
                <li>
                    <strong>5. Hasaplamalar:</strong> PV<sup>Œ≥</sup> √∂n√ºmini ba≈ülangy√ß we so≈àky √Ωagda√Ωlar √º√ßin hasapla≈à. Ikisi hem de≈àmi?
                    <br><small>‚úì Barlama: P‚ÇÅV‚ÇÅ<sup>Œ≥</sup> ‚âà P‚ÇÇV‚ÇÇ<sup>Œ≥</sup> (10% garamazlygy bilen)</small>
                </li>
                <li>
                    <strong>6. I≈üi≈à Hasaplanmagy:</strong> W = (P‚ÇÅV‚ÇÅ - P‚ÇÇV‚ÇÇ)/(Œ≥-1) formulasy bilen gazy≈à √Ωerine √Ωetiren i≈üini hasapla≈à.
                    <br><small>üí° D√º≈ü√ºndiri≈ü: O≈àyn W - gaz da≈üyna i≈ü etdi</small>
                </li>
            </ol>

            <div class="theory-box" style="background: linear-gradient(135deg, #fee2e2, #fef2f2); border-left-color: var(--danger);">
                <h3>‚ö†Ô∏è Howpsuzlyk D√ºzg√ºnleri:</h3>
                <ul style="margin: 15px 0 15px 30px;">
                    <li>√ùokary basy≈üly silindrlerde g√∂zl√ºk ulanmak</li>
                    <li>Piston √ßyk√Ωan wagty el √Ωakyn saklamak</li>
                    <li>Gi≈àelme wagtynda howany≈à sowuklamagyna √ºns bermek</li>
                    <li>Enjamlar doly berkidilmelidir</li>
                </ul>
            </div>
        </div>

        <div id="simulation" class="content-section">
            <h2>Interaktiw Simul√Ωasi√Ωa</h2>
            
            <div class="simulation-grid" style="margin-bottom: 20px;">
                <div style="background: var(--bg); padding: 15px; border-radius: 8px;">
                    <h3 style="margin-bottom: 10px;">Piston Hereketi</h3>
                    <canvas id="pistonCanvas"></canvas>
                </div>
                <div style="background: var(--bg); padding: 15px; border-radius: 8px;">
                    <h3 style="margin-bottom: 10px;">PV Diagrammasy</h3>
                    <canvas id="pvCanvas"></canvas>
                </div>
            </div>

            <div class="simulation-grid">
                <div style="background: var(--bg); padding: 15px; border-radius: 8px;">
                    <h3 style="margin-bottom: 10px;">Temperatura √ú√Ωtgemesi</h3>
                    <canvas id="tempCanvas"></canvas>
                </div>
                <div style="background: var(--bg); padding: 15px; border-radius: 8px;">
                    <h3 style="margin-bottom: 10px;">√ùerine √ùetirilen I≈ü</h3>
                    <canvas id="workCanvas"></canvas>
                </div>
            </div>

            <div class="controls">
                <h3>Giri≈ü Parametrleri</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="input-group">
                        <label>Ba≈ülangy√ß Basy≈ü (P‚ÇÅ) [kPa]:</label>
                        <input type="number" id="p1" value="100" min="50" max="300">
                    </div>
                    <div class="input-group">
                        <label>Ba≈ülangy√ß Udel (V‚ÇÅ) [L]:</label>
                        <input type="number" id="v1" value="1" min="0.1" max="5" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Ba≈ülangy√ß Temperatura (T‚ÇÅ) [K]:</label>
                        <input type="number" id="t1" value="300" min="200" max="400">
                    </div>
                    <div class="input-group">
                        <label>Gamma (Œ≥):</label>
                        <select id="gamma">
                            <option value="1.67">1.67 (bir atomly)</option>
                            <option value="1.40" selected>1.40 (iki atomly - howa)</option>
                            <option value="1.30">1.30 (k√∂p atomly)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>So≈àky Udel (V‚ÇÇ) [L]:</label>
                        <input type="number" id="v2" value="2" min="0.1" max="10" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Simul√Ωasi√Ωa Tizligi:</label>
                        <select id="speed">
                            <option value="50">Ha√Ωal</option>
                            <option value="20" selected>Orta</option>
                            <option value="5">√áalt</option>
                        </select>
                    </div>
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-primary" onclick="startSimulation()" id="startBtn">‚ñ∂Ô∏è Ba≈ülat</button>
                    <button class="btn btn-danger" onclick="stopSimulation()" id="stopBtn" disabled>‚è∏Ô∏è Dur</button>
                    <button class="btn btn-success" onclick="resetSimulation()">üîÑ T√§zele</button>
                    <button class="btn btn-primary" onclick="stepSimulation()" id="stepBtn">‚û°Ô∏è √Ñdim</button>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <div class="results" id="liveResults">
                <div class="result-card">
                    <div class="result-label">H√§zirki Basy≈ü (P)</div>
                    <div class="result-value" id="currentP">100.0 kPa</div>
                </div>
                <div class="result-card">
                    <div class="result-label">H√§zirki Udel (V)</div>
                    <div class="result-value" id="currentV">1.00 L</div>
                </div>
                <div class="result-card">
                    <div class="result-label">H√§zirki Temperatura (T)</div>
                    <div class="result-value" id="currentT">300.0 K</div>
                </div>
                <div class="result-card">
                    <div class="result-label">√ùerine √ùetirilen I≈ü (W)</div>
                    <div class="result-value" id="currentW">0.0 J</div>
                </div>
            </div>
        </div>

        <div id="results" class="content-section">
            <h2>Netijeler we Eksport</h2>
            
            <div class="theory-box">
                <h3>üìà Hasaplanan Netijeler:</h3>
                <div class="results">
                    <div class="result-card">
                        <div class="result-label">Ba≈ülangy√ß PV<sup>Œ≥</sup></div>
                        <div class="result-value" id="result_pv1">‚Äî</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">So≈àky PV<sup>Œ≥</sup></div>
                        <div class="result-value" id="result_pv2">‚Äî</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Temperatura √ú√Ωtgemesi (ŒîT)</div>
                        <div class="result-value" id="result_dt">‚Äî</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Jemi I≈ü (W)</div>
                        <div class="result-value" id="result_work">‚Äî</div>
                    </div>
                </div>
            </div>

            <div class="theory-box">
                <h3>üìã √ñl√ßegler Tablisasy:</h3>
                <div style="overflow-x: auto;">
                    <table id="dataTable" style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                        <thead>
                            <tr style="background: var(--primary); color: white;">
                                <th style="padding: 10px; border: 1px solid var(--border);">√Ñdim</th>
                                <th style="padding: 10px; border: 1px solid var(--border);">Udel (L)</th>
                                <th style="padding: 10px; border: 1px solid var(--border);">Basy≈ü (kPa)</th>
                                <th style="padding: 10px; border: 1px solid var(--border);">Temperatura (K)</th>
                                <th style="padding: 10px; border: 1px solid var(--border);">I≈ü (J)</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 20px;">Simul√Ωasi√Ωany ba≈ülady≈àyzdan so≈à maglumatlar g√∂r√ºner</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="exportCSV()">üì• CSV G√∂rn√º≈üinde √ù√ºkle</button>
                <button class="btn btn-primary" onclick="exportPDF()">üìÑ PDF G√∂rn√º≈üinde √ù√ºkle</button>
            </div>
        </div>
    </div>

    <script>
        let animationId = null;
        let isRunning = false;
        let currentStep = 0;
        let maxSteps = 100;
        let simulationData = [];
        let temperatureHistory = [];
        let workHistory = [];

        let state = {
            P: 100,
            V: 1,
            T: 300,
            W: 0
        };

        let params = {
            P1: 100,
            V1: 1,
            T1: 300,
            gamma: 1.4,
            V2: 2,
            speed: 20
        };

        function showTab(tabName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function initCanvases() {
            const canvases = ['pistonCanvas', 'pvCanvas', 'tempCanvas', 'workCanvas'];
            
            canvases.forEach(id => {
                const canvas = document.getElementById(id);
                if (canvas) {
                    const parent = canvas.parentElement;
                    const width = parent.offsetWidth - 40; // padding √º√ßin
                    canvas.width = width > 0 ? width : 600;
                    canvas.height = 400;
                }
            });
        }

        function drawPiston() {
            const canvas = document.getElementById('pistonCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            ctx.clearRect(0, 0, w, h);

            const cylW = w * 0.6;
            const cylH = h * 0.6;
            const cylX = (w - cylW) / 2;
            const cylY = (h - cylH) / 2;

            // Silindr
            ctx.fillStyle = '#e2e8f0';
            ctx.fillRect(cylX, cylY, cylW, cylH);
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 3;
            ctx.strokeRect(cylX, cylY, cylW, cylH);

            // Gaz (re≈àk temperatura g√∂r√§ √º√Ωtge√Ω√§r)
            const tempRatio = (state.T - 200) / 200;
            const red = Math.floor(100 + tempRatio * 155);
            const blue = Math.floor(255 - tempRatio * 155);
            ctx.fillStyle = `rgba(${red}, 100, ${blue}, 0.4)`;
            
            const gasWidth = (state.V / params.V2) * cylW;
            ctx.fillRect(cylX, cylY, gasWidth, cylH);

            // Piston
            const pistonX = cylX + gasWidth;
            ctx.fillStyle = '#64748b';
            ctx.fillRect(pistonX - 5, cylY - 20, 10, cylH + 40);
            
            // Piston ba≈üy
            ctx.fillStyle = '#94a3b8';
            ctx.fillRect(pistonX - 15, cylY + cylH/2 - 30, 30, 60);

            // Maglumatlar
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 14px Arial';
            ctx.fillText(`V = ${state.V.toFixed(2)} L`, 20, 30);
            ctx.fillText(`P = ${state.P.toFixed(1)} kPa`, 20, 50);
            ctx.fillText(`T = ${state.T.toFixed(1)} K`, 20, 70);
        }

        function drawPVDiagram() {
            const canvas = document.getElementById('pvCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            ctx.clearRect(0, 0, w, h);

            const padding = 60;
            const graphW = w - 2 * padding;
            const graphH = h - 2 * padding;

            // Oklar
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, h - padding);
            ctx.lineTo(w - padding, h - padding);
            ctx.stroke();

            // Ok atlary
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 14px Arial';
            ctx.fillText('V (L)', w - padding - 30, h - padding + 30);
            ctx.save();
            ctx.translate(20, padding + 30);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('P (kPa)', 0, 0);
            ctx.restore();

            // Adiabatik e√Ωri
            ctx.strokeStyle = '#2563eb';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            const Vmin = Math.min(params.V1, params.V2) * 0.8;
            const Vmax = Math.max(params.V1, params.V2) * 1.2;
            const K = params.P1 * Math.pow(params.V1, params.gamma);

            for (let i = 0; i <= 100; i++) {
                const V = Vmin + (Vmax - Vmin) * i / 100;
                const P = K / Math.pow(V, params.gamma);
                
                const x = padding + (V - Vmin) / (Vmax - Vmin) * graphW;
                const y = h - padding - (P / (params.P1 * 1.5)) * graphH;
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // H√§zirki nokat
            const currentX = padding + (state.V - Vmin) / (Vmax - Vmin) * graphW;
            const currentY = h - padding - (state.P / (params.P1 * 1.5)) * graphH;
            
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(currentX, currentY, 8, 0, 2 * Math.PI);
            ctx.fill();

            // Ba≈ülangy√ß we so≈àky nokatlar
            const x1 = padding + (params.V1 - Vmin) / (Vmax - Vmin) * graphW;
            const y1 = h - padding - (params.P1 / (params.P1 * 1.5)) * graphH;
            
            ctx.fillStyle = '#10b981';
            ctx.beginPath();
            ctx.arc(x1, y1, 6, 0, 2 * Math.PI);
            ctx.fill();

            const P2 = K / Math.pow(params.V2, params.gamma);
            const x2 = padding + (params.V2 - Vmin) / (Vmax - Vmin) * graphW;
            const y2 = h - padding - (P2 / (params.P1 * 1.5)) * graphH;
            
            ctx.fillStyle = '#7c3aed';
            ctx.beginPath();
            ctx.arc(x2, y2, 6, 0, 2 * Math.PI);
            ctx.fill();

            // Bellikler
            ctx.fillStyle = '#1e293b';
            ctx.font = '12px Arial';
            ctx.fillText('1', x1 - 15, y1 - 10);
            ctx.fillText('2', x2 + 10, y2 - 10);
        }

        function drawTemperatureGraph() {
            const canvas = document.getElementById('tempCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            ctx.clearRect(0, 0, w, h);

            const padding = 60;
            const graphW = w - 2 * padding;
            const graphH = h - 2 * padding;

            // Oklar
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, h - padding);
            ctx.lineTo(w - padding, h - padding);
            ctx.stroke();

            // Ok atlary
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 14px Arial';
            ctx.fillText('Wagt', w - padding - 40, h - padding + 30);
            ctx.save();
            ctx.translate(20, padding + 40);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('T (K)', 0, 0);
            ctx.restore();

            if (temperatureHistory.length < 2) return;

            // Temperatura e√Ωrisi
            const Tmin = Math.min(...temperatureHistory);
            const Tmax = Math.max(...temperatureHistory);
            const Trange = Tmax - Tmin || 1;

            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 3;
            ctx.beginPath();

            temperatureHistory.forEach((T, i) => {
                const x = padding + (i / (temperatureHistory.length - 1)) * graphW;
                const y = h - padding - ((T - Tmin) / Trange) * graphH;
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();

            // H√§zirki nokat
            const lastX = padding + graphW;
            const lastY = h - padding - ((temperatureHistory[temperatureHistory.length - 1] - Tmin) / Trange) * graphH;
            
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(lastX, lastY, 6, 0, 2 * Math.PI);
            ctx.fill();

            // Grid √ßyzyklary
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            for (let i = 0; i <= 4; i++) {
                const y = padding + (graphH / 4) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(w - padding, y);
                ctx.stroke();
                
                const T = Tmax - (Trange / 4) * i;
                ctx.fillStyle = '#64748b';
                ctx.font = '11px Arial';
                ctx.fillText(T.toFixed(0), padding - 40, y + 4);
            }
            ctx.setLineDash([]);

            // Ba≈ülangy√ß we so≈àky bahalar
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 12px Arial';
            ctx.fillText(`T‚ÇÅ = ${params.T1.toFixed(1)} K`, padding + 10, padding + 20);
            if (temperatureHistory.length > 1) {
                ctx.fillText(`T = ${temperatureHistory[temperatureHistory.length - 1].toFixed(1)} K`, 
                    w - padding - 100, padding + 20);
            }
        }

        function drawWorkGraph() {
            const canvas = document.getElementById('workCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;

            ctx.clearRect(0, 0, w, h);

            const padding = 60;
            const graphW = w - 2 * padding;
            const graphH = h - 2 * padding;

            // Oklar
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, h - padding);
            ctx.lineTo(w - padding, h - padding);
            ctx.stroke();

            // Ok atlary
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 14px Arial';
            ctx.fillText('Wagt', w - padding - 40, h - padding + 30);
            ctx.save();
            ctx.translate(20, padding + 40);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('W (J)', 0, 0);
            ctx.restore();

            if (workHistory.length < 2) return;

            // I≈ü e√Ωrisi
            const Wmax = Math.max(...workHistory) || 1;

            ctx.strokeStyle = '#10b981';
            ctx.lineWidth = 3;
            ctx.beginPath();

            workHistory.forEach((W, i) => {
                const x = padding + (i / (workHistory.length - 1)) * graphW;
                const y = h - padding - (W / Wmax) * graphH;
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();

            // Me√Ωdan (i≈ü integralyny≈à wizual g√∂rn√º≈üi)
            ctx.fillStyle = 'rgba(16, 185, 129, 0.2)';
            ctx.beginPath();
            ctx.moveTo(padding, h - padding);
            workHistory.forEach((W, i) => {
                const x = padding + (i / (workHistory.length - 1)) * graphW;
                const y = h - padding - (W / Wmax) * graphH;
                ctx.lineTo(x, y);
            });
            ctx.lineTo(w - padding, h - padding);
            ctx.closePath();
            ctx.fill();

            // H√§zirki nokat
            const lastX = padding + graphW;
            const lastY = h - padding - (workHistory[workHistory.length - 1] / Wmax) * graphH;
            
            ctx.fillStyle = '#10b981';
            ctx.beginPath();
            ctx.arc(lastX, lastY, 6, 0, 2 * Math.PI);
            ctx.fill();

            // Grid √ßyzyklary
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            for (let i = 0; i <= 4; i++) {
                const y = padding + (graphH / 4) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(w - padding, y);
                ctx.stroke();
                
                const W = Wmax - (Wmax / 4) * i;
                ctx.fillStyle = '#64748b';
                ctx.font = '11px Arial';
                ctx.fillText(W.toFixed(1), padding - 45, y + 4);
            }
            ctx.setLineDash([]);

            // Jemi i≈ü
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 12px Arial';
            if (workHistory.length > 1) {
                ctx.fillText(`W = ${workHistory[workHistory.length - 1].toFixed(2)} J`, 
                    padding + 10, padding + 20);
            }
        }

        function updateParameters() {
            params.P1 = parseFloat(document.getElementById('p1').value);
            params.V1 = parseFloat(document.getElementById('v1').value);
            params.T1 = parseFloat(document.getElementById('t1').value);
            params.gamma = parseFloat(document.getElementById('gamma').value);
            params.V2 = parseFloat(document.getElementById('v2').value);
            params.speed = parseInt(document.getElementById('speed').value);
        }

        function startSimulation() {
            if (isRunning) return;
            
            updateParameters();
            isRunning = true;
            currentStep = 0;
            simulationData = [];
            temperatureHistory = [];
            workHistory = [];
            
            state.P = params.P1;
            state.V = params.V1;
            state.T = params.T1;
            state.W = 0;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('stepBtn').disabled = true;
            
            animate();
        }

        function stopSimulation() {
            isRunning = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('stepBtn').disabled = false;
        }

        function resetSimulation() {
            stopSimulation();
            updateParameters();
            
            state.P = params.P1;
            state.V = params.V1;
            state.T = params.T1;
            state.W = 0;
            currentStep = 0;
            simulationData = [];
            temperatureHistory = [];
            workHistory = [];
            
            updateDisplay();
            drawPiston();
            drawPVDiagram();
            drawTemperatureGraph();
            drawWorkGraph();
            
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('dataTableBody').innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px;">Simul√Ωasi√Ωany ba≈ülady≈àyzdan so≈à maglumatlar g√∂r√ºner</td></tr>';
        }

        function stepSimulation() {
            if (currentStep < maxSteps) {
                updateState();
                currentStep++;
                updateDisplay();
                drawPiston();
                drawPVDiagram();
                drawTemperatureGraph();
                drawWorkGraph();
            }
        }

        function animate() {
            if (!isRunning) return;
            
            if (currentStep < maxSteps) {
                updateState();
                currentStep++;
                updateDisplay();
                drawPiston();
                drawPVDiagram();
                drawTemperatureGraph();
                drawWorkGraph();
                
                animationId = setTimeout(() => {
                    requestAnimationFrame(animate);
                }, params.speed);
            } else {
                stopSimulation();
                calculateFinalResults();
            }
        }

        function updateState() {
            const progress = currentStep / maxSteps;
            state.V = params.V1 + (params.V2 - params.V1) * progress;
            
            const K = params.P1 * Math.pow(params.V1, params.gamma);
            state.P = K / Math.pow(state.V, params.gamma);
            
            const KT = params.T1 * Math.pow(params.V1, params.gamma - 1);
            state.T = KT / Math.pow(state.V, params.gamma - 1);
            
            if (currentStep > 0) {
                const prevV = params.V1 + (params.V2 - params.V1) * (currentStep - 1) / maxSteps;
                const dV = state.V - prevV;
                state.W += state.P * dV;
            }
            
            // Her √§dimde temperatura we i≈ü ge√ßmi≈üine go≈ü
            temperatureHistory.push(state.T);
            workHistory.push(state.W);
            
            if (currentStep % 10 === 0) {
                simulationData.push({
                    step: currentStep,
                    V: state.V,
                    P: state.P,
                    T: state.T,
                    W: state.W
                });
            }
        }

        function updateDisplay() {
            document.getElementById('currentP').textContent = state.P.toFixed(1) + ' kPa';
            document.getElementById('currentV').textContent = state.V.toFixed(2) + ' L';
            document.getElementById('currentT').textContent = state.T.toFixed(1) + ' K';
            document.getElementById('currentW').textContent = state.W.toFixed(2) + ' J';
            
            const progress = (currentStep / maxSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function calculateFinalResults() {
            const K = params.P1 * Math.pow(params.V1, params.gamma);
            const P2 = K / Math.pow(params.V2, params.gamma);
            
            const PV1 = params.P1 * Math.pow(params.V1, params.gamma);
            const PV2 = P2 * Math.pow(params.V2, params.gamma);
            
            const T2 = params.T1 * Math.pow(params.V1 / params.V2, params.gamma - 1);
            const dT = T2 - params.T1;
            
            const W = (params.P1 * params.V1 - P2 * params.V2) / (params.gamma - 1);
            
            document.getElementById('result_pv1').textContent = PV1.toFixed(2);
            document.getElementById('result_pv2').textContent = PV2.toFixed(2);
            document.getElementById('result_dt').textContent = dT.toFixed(1) + ' K';
            document.getElementById('result_work').textContent = W.toFixed(2) + ' J';
            
            updateDataTable();
        }

        function updateDataTable() {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';
            
            simulationData.forEach(data => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td style="padding: 8px; border: 1px solid var(--border); text-align: center;">${data.step}</td>
                    <td style="padding: 8px; border: 1px solid var(--border); text-align: center;">${data.V.toFixed(3)}</td>
                    <td style="padding: 8px; border: 1px solid var(--border); text-align: center;">${data.P.toFixed(2)}</td>
                    <td style="padding: 8px; border: 1px solid var(--border); text-align: center;">${data.T.toFixed(2)}</td>
                    <td style="padding: 8px; border: 1px solid var(--border); text-align: center;">${data.W.toFixed(2)}</td>
                `;
            });
        }

        function exportCSV() {
            let csv = 'Adim,Udel(L),Basysh(kPa),Temperatura(K),Ish(J)\n';
            simulationData.forEach(data => {
                csv += `${data.step},${data.V.toFixed(3)},${data.P.toFixed(2)},${data.T.toFixed(2)},${data.W.toFixed(2)}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'adiabatik_netijeler.csv';
            link.click();
        }

        function exportPDF() {
            alert('PDF eksport funksi√Ωasy: Netije tablisasyny we grafikleri PDF formatda √Ω√ºklemek √º√ßin √Ω√∂rite PDF kitaphanasy zerur. H√§zirki wagtda CSV eksportyny ulany≈à.');
        }

        window.addEventListener('load', () => {
            // Canvas elementlerini≈à √Ω√ºklenendigini gara≈ü
            setTimeout(() => {
                initCanvases();
                drawPiston();
                drawPVDiagram();
                drawTemperatureGraph();
                drawWorkGraph();
            }, 100);
        });

        window.addEventListener('resize', () => {
            initCanvases();
            drawPiston();
            drawPVDiagram();
            drawTemperatureGraph();
            drawWorkGraph();
        });
    </script>
</body>
</html>